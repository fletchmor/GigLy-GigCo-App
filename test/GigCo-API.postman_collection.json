{
  "info": {
    "name": "GigCo Job API Tests",
    "description": "Comprehensive tests for GigCo job management endpoints",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health Check",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('status');",
              "    pm.expect(jsonData).to.have.property('database');",
              "    pm.expect(jsonData).to.have.property('timestamp');",
              "    pm.expect(jsonData.status).to.eql('healthy');",
              "    pm.expect(jsonData.database).to.eql('connected');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/health",
          "host": ["{{base_url}}"],
          "path": ["health"]
        }
      }
    },
    {
      "name": "Create Job - Valid Data",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 201', function () {",
              "    pm.response.to.have.status(201);",
              "});",
              "",
              "pm.test('Response has correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('id');",
              "    pm.expect(jsonData).to.have.property('uuid');",
              "    pm.expect(jsonData).to.have.property('title');",
              "    pm.expect(jsonData).to.have.property('description');",
              "    pm.expect(jsonData).to.have.property('status');",
              "    pm.expect(jsonData).to.have.property('created_at');",
              "    pm.expect(jsonData).to.have.property('updated_at');",
              "});",
              "",
              "pm.test('Job data matches request', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.title).to.eql('House Cleaning Service');",
              "    pm.expect(jsonData.description).to.eql('Deep cleaning of 3-bedroom house including kitchen, bathrooms, and living areas');",
              "    pm.expect(jsonData.category).to.eql('cleaning');",
              "    pm.expect(jsonData.status).to.eql('posted');",
              "});",
              "",
              "pm.test('Store job ID for later tests', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.environment.set('test_job_id', jsonData.id);",
              "    pm.environment.set('test_job_uuid', jsonData.uuid);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"House Cleaning Service\",\n  \"description\": \"Deep cleaning of 3-bedroom house including kitchen, bathrooms, and living areas\",\n  \"category\": \"cleaning\",\n  \"location_address\": \"123 Oak Street, Downtown, City 12345\",\n  \"location_latitude\": 40.7128,\n  \"location_longitude\": -74.0060,\n  \"estimated_duration_hours\": 4.0,\n  \"pay_rate_per_hour\": 25.00,\n  \"total_pay\": 100.00,\n  \"scheduled_start\": \"2025-08-15T09:00:00Z\",\n  \"scheduled_end\": \"2025-08-15T13:00:00Z\",\n  \"notes\": \"Please bring your own cleaning supplies\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/create",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "create"]
        }
      }
    },
    {
      "name": "Create Job - Minimal Data",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 201', function () {",
              "    pm.response.to.have.status(201);",
              "});",
              "",
              "pm.test('Required fields only work', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.title).to.eql('Garden Maintenance');",
              "    pm.expect(jsonData.description).to.eql('Basic lawn mowing and hedge trimming');",
              "    pm.expect(jsonData.status).to.eql('posted');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"Garden Maintenance\",\n  \"description\": \"Basic lawn mowing and hedge trimming\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/create",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "create"]
        }
      }
    },
    {
      "name": "Create Job - Invalid Data (Missing Title)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 400', function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test('Error message mentions title', function () {",
              "    const responseText = pm.response.text();",
              "    pm.expect(responseText.toLowerCase()).to.include('title');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"description\": \"This job has no title\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/create",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "create"]
        }
      }
    },
    {
      "name": "Create Job - Invalid Data (Short Description)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 400', function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test('Error message mentions description', function () {",
              "    const responseText = pm.response.text();",
              "    pm.expect(responseText.toLowerCase()).to.include('description');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"Valid Title\",\n  \"description\": \"Short\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/create",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "create"]
        }
      }
    },
    {
      "name": "Get All Jobs - Default Pagination",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('jobs');",
              "    pm.expect(jsonData).to.have.property('pagination');",
              "    pm.expect(jsonData.jobs).to.be.an('array');",
              "});",
              "",
              "pm.test('Pagination has correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    const pagination = jsonData.pagination;",
              "    pm.expect(pagination).to.have.property('page');",
              "    pm.expect(pagination).to.have.property('limit');",
              "    pm.expect(pagination).to.have.property('total');",
              "    pm.expect(pagination).to.have.property('pages');",
              "    pm.expect(pagination).to.have.property('has_next');",
              "    pm.expect(pagination).to.have.property('has_prev');",
              "});",
              "",
              "pm.test('Jobs have correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    if (jsonData.jobs.length > 0) {",
              "        const job = jsonData.jobs[0];",
              "        pm.expect(job).to.have.property('id');",
              "        pm.expect(job).to.have.property('uuid');",
              "        pm.expect(job).to.have.property('title');",
              "        pm.expect(job).to.have.property('description');",
              "        pm.expect(job).to.have.property('status');",
              "        pm.expect(job).to.have.property('consumer');",
              "        pm.expect(job.consumer).to.have.property('name');",
              "    }",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs"]
        }
      }
    },
    {
      "name": "Get Jobs - With Pagination",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Pagination reflects query parameters', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.pagination.page).to.eql(1);",
              "    pm.expect(jsonData.pagination.limit).to.eql(5);",
              "});",
              "",
              "pm.test('Jobs array respects limit', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.jobs.length).to.be.at.most(5);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs?page=1&limit=5",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs"],
          "query": [
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "limit",
              "value": "5"
            }
          ]
        }
      }
    },
    {
      "name": "Get Jobs - Filter by Status",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('All returned jobs have posted status', function () {",
              "    const jsonData = pm.response.json();",
              "    jsonData.jobs.forEach(function(job) {",
              "        pm.expect(job.status).to.eql('posted');",
              "    });",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs?status=posted",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs"],
          "query": [
            {
              "key": "status",
              "value": "posted"
            }
          ]
        }
      }
    },
    {
      "name": "Get Jobs - Filter by Category",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('All returned jobs have cleaning category', function () {",
              "    const jsonData = pm.response.json();",
              "    jsonData.jobs.forEach(function(job) {",
              "        if (job.category) {",
              "            pm.expect(job.category).to.eql('cleaning');",
              "        }",
              "    });",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs?category=cleaning",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs"],
          "query": [
            {
              "key": "category",
              "value": "cleaning"
            }
          ]
        }
      }
    },
    {
      "name": "Get Job by ID - Valid ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Response has correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('id');",
              "    pm.expect(jsonData).to.have.property('uuid');",
              "    pm.expect(jsonData).to.have.property('title');",
              "    pm.expect(jsonData).to.have.property('description');",
              "    pm.expect(jsonData).to.have.property('status');",
              "    pm.expect(jsonData).to.have.property('consumer');",
              "    pm.expect(jsonData.consumer).to.have.property('name');",
              "});",
              "",
              "pm.test('Job ID matches request', function () {",
              "    const jsonData = pm.response.json();",
              "    const requestedId = parseInt(pm.environment.get('test_job_id'));",
              "    pm.expect(jsonData.id).to.eql(requestedId);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/{{test_job_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "{{test_job_id}}"]
        }
      }
    },
    {
      "name": "Get Job by ID - Invalid ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 400', function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test('Error response has correct structure', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('error');",
              "    pm.expect(jsonData.error.toLowerCase()).to.include('invalid');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/invalid",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "invalid"]
        }
      }
    },
    {
      "name": "Get Job by ID - Non-existent ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 404', function () {",
              "    pm.response.to.have.status(404);",
              "});",
              "",
              "pm.test('Error response indicates not found', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('error');",
              "    pm.expect(jsonData.error.toLowerCase()).to.include('not found');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/99999",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "99999"]
        }
      }
    },
    {
      "name": "Accept Job - Valid Request",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Success response structure', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData).to.have.property('message');",
              "    pm.expect(jsonData).to.have.property('job_id');",
              "    pm.expect(jsonData).to.have.property('job_uuid');",
              "    pm.expect(jsonData.success).to.be.true;",
              "});",
              "",
              "pm.test('Job ID matches expected', function () {",
              "    const jsonData = pm.response.json();",
              "    const expectedId = parseInt(pm.environment.get('test_job_id'));",
              "    pm.expect(jsonData.job_id).to.eql(expectedId);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"gig_worker_id\": 4\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/{{test_job_id}}/accept",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "{{test_job_id}}", "accept"]
        }
      }
    },
    {
      "name": "Accept Job - Already Accepted",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 409', function () {",
              "    pm.response.to.have.status(409);",
              "});",
              "",
              "pm.test('Error message indicates conflict', function () {",
              "    const responseText = pm.response.text();",
              "    pm.expect(responseText.toLowerCase()).to.include('not found').or.include('already').or.include('not available');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"gig_worker_id\": 5\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/{{test_job_id}}/accept",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "{{test_job_id}}", "accept"]
        }
      }
    },
    {
      "name": "Accept Job - Missing Gig Worker ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 400', function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test('Error message mentions gig worker ID', function () {",
              "    const responseText = pm.response.text();",
              "    pm.expect(responseText.toLowerCase()).to.include('gig worker id');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/{{test_job_id}}/accept",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "{{test_job_id}}", "accept"]
        }
      }
    },
    {
      "name": "Verify Job Status Changed",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test('Job status is now accepted', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData.status).to.eql('accepted');",
              "});",
              "",
              "pm.test('Job has gig worker assigned', function () {",
              "    const jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('gig_worker_id');",
              "    pm.expect(jsonData.gig_worker_id).to.not.be.null;",
              "    pm.expect(jsonData).to.have.property('gig_worker');",
              "    pm.expect(jsonData.gig_worker).to.have.property('name');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/{{test_job_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "{{test_job_id}}"]
        }
      }
    },
    {
      "name": "Create Job for Performance Test",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Response time is less than 1000ms', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(1000);",
              "});",
              "",
              "pm.test('Status code is 201', function () {",
              "    pm.response.to.have.status(201);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"title\": \"Performance Test Job {{$timestamp}}\",\n  \"description\": \"This is a performance test job created at {{$timestamp}}\",\n  \"category\": \"testing\",\n  \"pay_rate_per_hour\": 15.00\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/v1/jobs/create",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs", "create"]
        }
      }
    },
    {
      "name": "Get Jobs Performance Test",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test('Response time is less than 500ms', function () {",
              "    pm.expect(pm.response.responseTime).to.be.below(500);",
              "});",
              "",
              "pm.test('Status code is 200', function () {",
              "    pm.response.to.have.status(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/v1/jobs?limit=50",
          "host": ["{{base_url}}"],
          "path": ["api", "v1", "jobs"],
          "query": [
            {
              "key": "limit",
              "value": "50"
            }
          ]
        }
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080"
    }
  ]
}